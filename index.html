<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Eye Visualization</title>
    <!-- Bulma Style Sheet -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bulma-extensions@6.2.7/dist/js/bulma-extensions.min.js"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <!-- Load d3.js -->
    <script src="https://d3js.org/d3.v4.js"></script>
    <!-- Load ChartsJS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.2/dist/Chart.min.js"></script>
    <!-- data -->
    <script src="Data/Others/participant_data.js"></script>
    <script type="text/javascript" src="Data/json_data/p1/p1treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p2/p2treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p3/p3treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p4/p4treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p5/p5treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p6/p6treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p7/p7treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p10/p10treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p11/p11treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p12/p12treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p13/p13treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p14/p14treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p15/p15treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p16/p16treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p17/p17treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p18/p18treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p19/p19treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p20/p20treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p21/p21treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p23/p23treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p24/p24treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p25/p25treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p27/p27treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p28/p28treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p30/p30treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p31/p31treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p32/p32treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p33/p33treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p34/p34treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p35/p35treeFXD.json"></script>
    <script type="text/javascript" src="Data/json_data/p36/p36treeFXD.json"></script>
</head>

<body>
    <div class="columns">
        <!-- This section is the context menu HTML -->
        <div class="column is-2 dark">
            <div class="context-menu hero is-fullheight">
                <aside class="menu">
                    <p class="menu-label">
                        Eye Tracking Visualization
                    </p>
                    <ul class="menu-list">
                        <li><a onclick="load('Time_Visualization')">Time Path Comparison</a></li>
                        <li><a onclick="load('Convex_Visualization')">Convex Hull Comparison</a></li>
                        <li><a onclick="load('Participant_Visualization')">Participant Comparison</a></li>
                    </ul>
                    <p class="menu-label">
                        Session Visualization
                    </p>
                    <ul class="menu-list">
                        <li><a onclick="load('Session_Overview')">Overview</a></li>
                        <li><a onclick="load('Time_Comparison')">Time Comparison</a></li>
                        <li><a onclick="load('Completion_Comparison')">Completion Comparison</a></li>
                        <li><a onclick="load('Session_Comparison')">Session Comparison</a></li>
                    </ul>
                </aside>
            </div>
        </div>
        <!-- End of context menu HTML -->
        <!-- This section is the Visualization Code for every visualization image we are creating -->
        <div class="column">
            <div id="Time_Visualization" class="start"> Time Visualization </div>
            <div id="Convex_Visualization" class="default">
                <div class="title">Convex Hull Comparison</div>
                <div class="cvElement">

                </div>
                <div class="cvElement" id="cvCheckbox">
                    <div class="CVboxes">
                        <input type="checkbox" name="cvCheckbox" id="cvP1"> Participant 1<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP2"> Participant 2<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP3"> Participant 3<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP4"> Participant 4<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP5"> Participant 5<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP6"> Participant 6<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP7"> Participant 7<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP8"> Participant 10<br />
                    </div>
                    <div class="CVboxes">
                        <input type="checkbox" name="cvCheckbox" value="cvP9"> Participant 11<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP10"> Participant 12<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP11"> Participant 13<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP12"> Participant 14<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP13"> Participant 15<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP14"> Participant 16<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP15"> Participant 17<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP16"> Participant 18<br />
                    </div>
                    <div class="CVboxes">
                        <input type="checkbox" name="cvCheckbox" value="cvP17"> Participant 19<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP18"> Participant 20<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP19"> Participant 21<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP20"> Participant 23<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP21"> Participant 24<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP22"> Participant 25<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP23"> Participant 27<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP24"> Participant 28<br />
                    </div>
                    <div class="CVboxes">
                        <input type="checkbox" name="cvCheckbox" value="cvP26"> Participant 30<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP27"> Participant 31<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP28"> Participant 32<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP29"> Participant 33<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP30"> Participant 34<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP31"> Participant 35<br />
                        <input type="checkbox" name="cvCheckbox" value="cvP32"> Participant 36<br />
                        <input type="checkbox" onClick="toggleCVcheckbox(this)" /> Toggle all Participants<br />
                    </div>
                </div>
                <div class="cvElement">
                    <input type="submit" value="Show Visualization" onClick="createTreeSummary();">
                </div>
                <div class="cvElement" id="summary_holder">
                    <div id="summary_visualization"></div>
                </div>

            </div>
            <div id="Participant_Visualization" class="default">
                <div class="title">Participant Overview</div>
                <button id="Session_Comparison_Tree" class="button space button_selected"
                    onclick="switchSessionOverview('Session_Comparison_Tree')"><i class="fas fa-tree"></i> &nbsp;
                    Tree</button>
                <button id="Session_Comparison_Graph" class="button space"
                    onclick="switchSessionOverview('Session_Comparison_Graph')"><i class="fas fa-project-diagram"></i>
                    &nbsp; Graph</button>
                <div class="tile is-vertical is-ancestor">
                    <div class="tile is-parent">
                        <div id="General_Session_Time_Average_Container" class="tile notification juicy space">
                            <canvas id="General_Session_Time_Average" class="tile_canvas"></canvas>
                        </div>
                        <div id="Expert_Session_Time_Average_Container" class="tile notification juicy space">
                            <canvas id="Expert_Session_Time_Average" class="tile_canvas"></canvas>
                        </div>
                    </div>
                    <div class="tile is-parent">
                        <div id="General_Session_Success_Average_Container" class="tile notification juicy space">
                            <canvas id="General_Session_Success_Average" class="tile_canvas"></canvas>
                        </div>
                        <div id="Expert_Session_Success_Average_Container" class="tile notification juicy space">
                            <canvas id="Expert_Session_Success_Average" class="tile_canvas"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div id="Session_Overview" class="default">
                <div class="title">Session Overview</div>
                <div class="tile is-vertical is-ancestor">
                    <div class="tile is-parent">
                        <div id="session_overview_visualization_container" class="tile notification juicy space">
                            <canvas id="session_overview_visualization_time" class="tile_canvas"></canvas>
                        </div>
                        <div id="session_overview_visualization_container" class="tile notification juicy space">
                            <canvas id="session_overview_visualization_success" class="tile_canvas"></canvas>
                        </div>
                    </div>
                </div>

            </div>
            <div id="Time_Comparison" class="default">
                <div class="title">Time Comparison Visualization</div>
                <div>
                    <label class="selector_label">Ontology:</label>
                    <button id="Time_Comparison_General" class="button comparison_button_selected"
                        onclick="refreshTimeComparisonChart(1)"><i class="fas fa-info-circle"></i> &nbsp;
                        General
                    </button>
                    <button id="Time_Comparison_Expert" class="button" onclick="refreshTimeComparisonChart(2)"><i
                            class="fas fa-atlas"></i>&nbsp;
                        Expert
                    </button>
                    <div id="time_comparison_visualization_container">
                        <canvas id="time_comparison_visualization" class="comparison_canvas"></canvas>
                    </div>
                </div>
            </div>

            <div id="Completion_Comparison" class="default">
                <div class="title">Completion Comparison Visualization</div>
                <div>
                    <label class="selector_label">Ontology:</label>
                    <button id="Completion_Comparison_General" class="button comparison_button_selected"
                        onclick="refreshCompletionComparisonChart(1)"><i class="fas fa-info-circle"></i> &nbsp;
                        General
                    </button>
                    <button id="Completion_Comparison_Expert" class="button"
                        onclick="refreshCompletionComparisonChart(2)"><i class="fas fa-atlas"></i>&nbsp;
                        Expert
                    </button>
                    <div id="completion_comparison_visualization_container">
                        <canvas id="completion_comparison_visualization" class="comparison_canvas"></canvas>
                    </div>
                </div>
            </div>

            <div id="Session_Comparison" class="default"></div>
        </div>
        <!-- End of Visualization Section -->
    </div>


    <!-- Javascript Section -->
    <!-- Embedded Javascript for the context menu-->
    <script>
        function load(id) {
            document.getElementById("Time_Visualization").style.display = "none";
            document.getElementById("Convex_Visualization").style.display = "none";
            document.getElementById("Participant_Visualization").style.display = "none";
            document.getElementById("Session_Overview").style.display = "none";
            document.getElementById("Time_Comparison").style.display = "none";
            document.getElementById("Completion_Comparison").style.display = "none";
            document.getElementById("Session_Comparison").style.display = "none";
            document.getElementById(id).style.display = "block";
        }
    </script>
    <!-- Embedded Javascript for Participant_Overview-->
    <script>
        // Locating Session Visualization Overview canvas tiles
        var generalSessionTime = document.getElementById("General_Session_Time_Average");
        var generalSessionSuccess = document.getElementById("General_Session_Success_Average");
        var expertSessionTime = document.getElementById("Expert_Session_Time_Average");
        var expertSessionSuccess = document.getElementById("Expert_Session_Success_Average");
        // Set current comparison to tree (Tree = 1 Graph = 2)
        var sessionOverviewComparisonType = 1;
        // Create the Radar Visualization on the Session Comparison Overview
        refreshSessionOverviewChart();
        // Title is the Title of the visualization
        // canvasElement is the element on the DOM we are drawing onto
        // The participant data
        // Type is a bool value -> true = Time | false = Success
        function generateNewRadarChart(title, canvasElement, data, type) {
            var labels = []; // Participants
            var values = []; // Data Value
            var timeAverage = 0;
            var successAverage = 0;
            // Data Processing (filtering for time or success percentage)
            data.forEach(element => {
                labels.push(element.ID);
                if (type) {
                    values.push(element.Time_On_Task)
                } else {
                    values.push(element.Task_Success * 100)
                }
                timeAverage += element.Time_On_Task;
                successAverage += (element.Task_Success * 100);
            });
            timeAverage = timeAverage / data.length;
            successAverage = successAverage / data.length;
            // Afix the average value onto the title
            title = title + ": " + (type ? timeAverage.toFixed(2) + " min" : successAverage.toFixed(2) + "%");
            new Chart(canvasElement, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        data: values,
                        backgroundColor: type ? "rgba(165, 192, 238, 0.5)" : "rgba(251, 197, 236, 0.5)",
                        fillOpacity: .5,
                        borderWidth: 1
                    }]
                },
                options: {
                    scale: {
                        pointLabels: {
                            fontSize: 15,
                            fontColor: "#FFFFFF"
                        },
                        ticks: {
                            suggestedMin: 0,
                            suggestedMax: type ? 50 : 100
                        }
                    },
                    legend: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: title,
                        fontSize: 30,
                        fontColor: "#FFFFFF",
                        fontStyle: "bolder",
                        padding: 2
                    }
                }
            });

        }

        function destroySessionOverviewCanvas(holder, containerName, canvasName) {
            var container = document.getElementById(containerName);
            container.removeChild(holder);
            var canvas = document.createElement('canvas');
            canvas.id = canvasName;
            canvas.className = "tile_canvas";
            container.appendChild(canvas);
        }

        function refreshSessionOverviewChart() {
            destroySessionOverviewCanvas(generalSessionTime, "General_Session_Time_Average_Container",
                "General_Session_Time_Average");
            destroySessionOverviewCanvas(expertSessionTime, "Expert_Session_Time_Average_Container",
                "Expert_Session_Time_Average");
            destroySessionOverviewCanvas(generalSessionSuccess, "General_Session_Success_Average_Container",
                "General_Session_Success_Average");
            destroySessionOverviewCanvas(expertSessionSuccess, "Expert_Session_Success_Average_Container",
                "Expert_Session_Success_Average");
            generalSessionTime = document.getElementById("General_Session_Time_Average");
            generalSessionSuccess = document.getElementById("General_Session_Success_Average");
            expertSessionTime = document.getElementById("Expert_Session_Time_Average");
            expertSessionSuccess = document.getElementById("Expert_Session_Success_Average");
            generateNewRadarChart("General Time Average", generalSessionTime, participants
                .filter((e) => {
                    return e.Ontologies === 1 && e.Visualization === sessionOverviewComparisonType;
                }), true);
            generateNewRadarChart("Expert Time Average", expertSessionTime, participants
                .filter((e) => {
                    return e.Ontologies === 2 && e.Visualization === sessionOverviewComparisonType;
                }), true);
            generateNewRadarChart("General Success Average", generalSessionSuccess,
                participants.filter((e) => {
                    return e.Ontologies === 1 && e.Visualization === sessionOverviewComparisonType;
                }), false);
            generateNewRadarChart("Expert Success Average", expertSessionSuccess,
                participants.filter((e) => {
                    return e.Ontologies === 2 && e.Visualization === sessionOverviewComparisonType;
                }), false);
        }

        function switchSessionOverview(type) {
            var tree = document.getElementById("Session_Comparison_Tree");
            var graph = document.getElementById("Session_Comparison_Graph");
            tree.className = "button space";
            graph.className = "button space"
            if (type === "Session_Comparison_Tree") {
                sessionOverviewComparisonType = 1;
                tree.className += " button_selected";
            } else {
                sessionOverviewComparisonType = 2;
                graph.className += " button_selected";
            }
            refreshSessionOverviewChart();
        }
    </script>
    <!-- Embedded Javascript for Session_Overview -->
    <script>
        var session_overview_visualization_time = document.getElementById("session_overview_visualization_time");
        var session_overview_visualization_success = document.getElementById("session_overview_visualization_success");
        createSessionOverviewVisualization();

        function createSessionOverviewVisualization() {
            var generalTree = participants.filter((e) => {
                return e.Ontologies === 1 && e.Visualization === 1;
            });
            var generalGraph = participants.filter((e) => {
                return e.Ontologies === 1 && e.Visualization === 2;
            });
            var expertTree = participants.filter((e) => {
                return e.Ontologies === 2 && e.Visualization === 1;
            });
            var expertGraph = participants.filter((e) => {
                return e.Ontologies === 2 && e.Visualization === 2;
            });

            var gTreeTime = 0;
            var gGraphTime = 0;
            var gTreeSuccess = 0;
            var gGraphSuccess = 0;
            var eTreeTime = 0;
            var eGraphTime = 0;
            var eTreeSuccess = 0;
            var eGraphSucess = 0;
            var labels = ["Tree", "Graph"];
            generalTree.forEach((e) => {
                gTreeTime += e.Time_On_Task;
                gTreeSuccess += (e.Task_Success * 100)
            })
            generalGraph.forEach((e) => {
                gGraphTime += e.Time_On_Task;
                gGraphSuccess += (e.Task_Success * 100)
            })
            expertTree.forEach((e) => {
                eTreeTime += e.Time_On_Task;
                eTreeSuccess += (e.Task_Success * 100);
            })
            expertGraph.forEach((e) => {
                eGraphTime += e.Time_On_Task;
                eGraphSucess += (e.Task_Success * 100);
            })
            gTreeTime /= generalTree.length;
            gGraphTime /= generalGraph.length;
            gTreeSuccess /= generalTree.length;
            gGraphSuccess /= generalGraph.length;
            eTreeTime /= expertTree.length;
            eGraphTime /= expertGraph.length;
            eTreeSuccess /= expertTree.length;
            eGraphSucess /= expertGraph.length;
            var generalDataSet = [{
                label: "General",
                backgroundColor: "blue",
                data: [gTreeTime, eTreeTime]
            }, {
                label: "Expert",
                backgroundColor: "red",
                data: [gGraphTime, eGraphTime]
            }];
            var expertDataSet = [{
                label: "General",
                backgroundColor: "blue",
                data: [gTreeSuccess, gGraphSuccess]
            }, {
                label: "Expert",
                backgroundColor: "red",
                data: [eTreeSuccess, eGraphSucess]
            }]


            new Chart(session_overview_visualization_time, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: generalDataSet
                },
                options: {
                    legend: {
                        labels: {
                            fontColor: 'white'
                        }
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                fontColor: 'white',
                                beginAtZero: true
                            }
                        }],
                        xAxes: [{
                            ticks: {
                                fontColor: 'white'
                            }
                        }]
                    },
                    title: {
                        display: true,
                        text: "Time",
                        fontSize: 30,
                        fontColor: "#FFFFFF",
                        fontStyle: "bolder",
                        padding: 2
                    }
                }
            })
            new Chart(session_overview_visualization_success, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: expertDataSet
                },
                options: {
                    legend: {
                        labels: {
                            fontColor: 'white'
                        }
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                fontColor: 'white',
                                beginAtZero: true
                            }
                        }],
                        xAxes: [{
                            ticks: {
                                fontColor: 'white'
                            }
                        }]
                    },
                    title: {
                        display: true,
                        text: "Completion",
                        fontSize: 30,
                        fontColor: "#FFFFFF",
                        fontStyle: "bolder",
                        padding: 2
                    }
                }
            })
        }
    </script>
    <!-- Embedded Javascript for Time_Comparison -->
    <script>
        var timeComparisonVisualizaton = document.getElementById("time_comparison_visualization");
        // value 1 = General | value 2 = Expert
        var timeVisualizationSelectorValue = 1;
        createTimeComparisonChart();
        Chart.pluginService.register({
            afterDraw: function (chart) {
                if (typeof chart.config.options.lineAt != 'undefined') {
                    var treeValue = chart.config.options.lineAt.treeValue;
                    var treeColor = chart.config.options.lineAt.treeColor;
                    var graphValue = chart.config.options.lineAt.graphValue;
                    var graphColor = chart.config.options.lineAt.graphColor;
                    var ctxPlugin = chart.chart.ctx;
                    var xAxe = chart.scales[chart.config.options.scales.xAxes[0].id];
                    var yAxe = chart.scales[chart.config.options.scales.yAxes[0].id];

                    if (yAxe.min != 0) return;

                    ctxPlugin.strokeStyle = treeColor;
                    ctxPlugin.beginPath();
                    var lineAt = (treeValue - yAxe.min) * (100 / yAxe.max);
                    lineAt = (100 - lineAt) / 100 * (yAxe.height) + yAxe.top;
                    ctxPlugin.moveTo(xAxe.left, lineAt);
                    ctxPlugin.lineTo(xAxe.right, lineAt);
                    ctxPlugin.stroke();

                    ctxPlugin.strokeStyle = graphColor;
                    ctxPlugin.beginPath();
                    var lineAt = (graphValue - yAxe.min) * (100 / yAxe.max);
                    lineAt = (100 - lineAt) / 100 * (yAxe.height) + yAxe.top;
                    ctxPlugin.moveTo(xAxe.left, lineAt);
                    ctxPlugin.lineTo(xAxe.right, lineAt);
                    ctxPlugin.stroke();

                }
            }
        })

        function createTimeComparisonChart() {
            var labels = [];
            var values = [{
                label: "Tree",
                backgroundColor: "Red",
                data: []

            }, {
                label: "Graph",
                backgroundColor: "Blue",
                data: []
            }];
            var treeTimeAverage = 0;
            var graphTimeAverage = 0;
            var treeCounter = 0;
            var graphCounter = 0
            participants.forEach((participant) => {
                var ontologySearchValue = timeVisualizationSelectorValue;
                if (participant.Ontologies === ontologySearchValue) {
                    labels.push(participant.ID);
                    if (participant.Visualization === 1) {
                        treeTimeAverage += participant.Time_On_Task;
                        values[0].data.push(participant.Time_On_Task);
                        values[1].data.push(0);
                        treeCounter++;
                    } else {
                        graphTimeAverage += participant.Time_On_Task;
                        values[0].data.push(0);
                        values[1].data.push(participant.Time_On_Task);
                        graphCounter++;
                    }
                }

            });
            treeTimeAverage = treeTimeAverage / treeCounter;
            graphTimeAverage = graphTimeAverage / graphCounter;
            new Chart(timeComparisonVisualizaton, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: values,
                    options: {
                        barValueSpacing: 5,
                        scales: {
                            yAxes: [{
                                ticks: {
                                    min: 0,
                                }
                            }]
                        }
                    }
                },
                options: {
                    lineAt: {
                        treeValue: treeTimeAverage,
                        treeColor: "Red",
                        graphValue: graphTimeAverage,
                        graphColor: "Blue"
                    }
                }
            });
        }

        function refreshTimeComparisonChart(value) {
            timeVisualizationSelectorValue = value;
            var general = document.getElementById("Time_Comparison_General");
            var expert = document.getElementById("Time_Comparison_Expert");
            var container = document.getElementById("time_comparison_visualization_container");
            general.className = "button";
            expert.className = "button";
            switch (value) {
                case 1:
                    general.className = "button comparison_button_selected";
                    break;
                case 2:
                    expert.className = "button comparison_button_selected";
                    break;
            }
            container.removeChild(timeComparisonVisualizaton);
            var canvas = document.createElement('canvas');
            canvas.id = "time_comparison_visualization";
            canvas.className = "comparison_canvas";
            container.appendChild(canvas);
            timeComparisonVisualizaton = document.getElementById("time_comparison_visualization");
            createTimeComparisonChart();
        }
    </script>
    <!-- Embedded Javascript for Success_Comparison -->
    <script>
        var completionComparisionVisualization = document.getElementById("completion_comparison_visualization");
        // value 1 = General | value 2 = Expert
        var completionVisualizationSelectorValue = 1;
        createCompletionComparisonChart();

        function createCompletionComparisonChart() {
            var labels = [];
            var values = [{
                label: "Tree",
                backgroundColor: "Red",
                data: []
            }, {
                label: "Graph",
                backgroundColor: "Blue",
                data: []
            }];
            var treeSuccessAverage = 0;
            var graphSuccessAverage = 0;
            var treeCounter = 0;
            var graphCounter = 0
            participants.forEach((participant) => {
                // Show Tree and Graph Comparison
                var ontologySearchValue = completionVisualizationSelectorValue;
                if (participant.Ontologies === ontologySearchValue) {
                    labels.push(participant.ID);
                    if (participant.Visualization === 1) {
                        treeSuccessAverage += (participant.Task_Success * 100);
                        treeCounter++;
                        values[0].data.push(participant.Task_Success * 100);
                        values[1].data.push(0);
                    } else {
                        graphSuccessAverage += (participant.Task_Success * 100);
                        graphCounter++;
                        values[0].data.push(0);
                        values[1].data.push(participant.Task_Success * 100);
                    }
                }
            });
            treeSuccessAverage = treeSuccessAverage / treeCounter;
            graphSuccessAverage = graphSuccessAverage / graphCounter;
            new Chart(completionComparisionVisualization, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: values,
                    options: {
                        barValueSpacing: 5,
                        scales: {
                            yAxes: [{
                                ticks: {
                                    max: 100,
                                    min: 0,
                                    stepSize: 10
                                }
                            }]
                        }
                    }
                },
                options: {
                    lineAt: {
                        treeValue: treeSuccessAverage,
                        treeColor: "Red",
                        graphValue: graphSuccessAverage,
                        graphColor: "Blue"
                    }
                }

            });

        }

        function refreshCompletionComparisonChart(value) {
            completionVisualizationSelectorValue = value;
            var general = document.getElementById("Completion_Comparison_General");
            var expert = document.getElementById("Completion_Comparison_Expert");
            var container = document.getElementById("completion_comparison_visualization_container");
            general.className = "button";
            expert.className = "button";
            switch (value) {
                case 1:
                    general.className = "button comparison_button_selected";
                    break;
                case 2:
                    expert.className = "button comparison_button_selected";
                    break;
            }
            container.removeChild(completionComparisionVisualization);
            var canvas = document.createElement('canvas');
            canvas.id = "completion_comparison_visualization";
            canvas.className = "comparison_canvas";
            container.appendChild(canvas);
            completionComparisionVisualization = document.getElementById("completion_comparison_visualization");
            createCompletionComparisonChart();
        }
    </script>

    <!-- Embedded Javascript for Convex_Visualization -->
    <script>
        var CVactive = false;
        var CVtreeFXDvis = [treeFXD1, treeFXD2, treeFXD3, treeFXD4, treeFXD5, treeFXD6, treeFXD7,
            treeFXD10, treeFXD11, treeFXD12, treeFXD13, treeFXD14, treeFXD15, treeFXD16,
            treeFXD17, treeFXD18, treeFXD19, treeFXD20, treeFXD21, treeFXD23,
            treeFXD24, treeFXD25, treeFXD27, treeFXD28, treeFXD30,
            treeFXD31, treeFXD32, treeFXD33, treeFXD34, treeFXD35, treeFXD36];
        // Defining Functions

        function toggleCVcheckbox(source) {
            checkboxes = document.getElementsByName('cvCheckbox');
            for (var i = 0, n = checkboxes.length; i < n; i++) {
                checkboxes[i].checked = source.checked;
            }
        }


        window.onload = function onLoadFunction() {
            createTreeSummary();
        }

        function createTreeSummary() {
            // set the dimensions and margins of the graph
            if (CVactive) {
                d3.select("#summary_visualization").remove();
                var container = document.getElementById("summary_holder");
                container.className = "cvElement";
                var svgContainer = document.createElement("DIV");
                svgContainer.id = "summary_visualization";
                container.appendChild(svgContainer);
            }
            CVactive = true;
            var margin = {
                top: 10,
                right: 0,
                bottom: 35,
                left: 62
            },
                width = 700,
                height = 500;
            // append the svg object to the body of the page
            var svg = d3.select("#summary_visualization")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform",
                    "translate(" + margin.left + "," + margin.top + ")");

            var maxTreeY = -1;
            var maxTreeX = -1;
            var minTreeX = -1;
            var minTreeY = -1;
            var CVtitle = "Participant(s): ";
            var CVCheckboxElements = document.getElementsByName("cvCheckbox");
            for (var i = 0; i < CVCheckboxElements.length; i++) {
                if (CVCheckboxElements[i].checked) {
                    if (i >= 0 && i < 7) { // p1-p7
                        CVtitle = CVtitle + (i + 1).toString() + ", ";
                    } else if (i >= 7 && i < 22) { //p10-p25 
                        CVtitle = CVtitle + (i + 3).toString() + ", ";
                    } else if (i >= 22 && i < 24) { //p27-p28 
                        CVtitle = CVtitle + (i + 5).toString() + ", ";
                    } else {
                        CVtitle = CVtitle + (i + 6).toString() + ", ";
                    }
                    if (maxTreeY == -1) {
                        maxTreeY = getTreeFXDYMax(CVtreeFXDvis[i]);
                        maxTreeX = getTreeFXDXMax(CVtreeFXDvis[i]);
                        minTreeX = getTreeFXDXMin(CVtreeFXDvis[i]);
                        minTreeY = getTreeFXDYMin(CVtreeFXDvis[i]);
                    } else {
                        var CVTempMinMax = getTreeFXDYMax(CVtreeFXDvis[i]);
                        if (CVTempMinMax > maxTreeY) maxTreeY = CVTempMinMax;
                        CVTempMinMax = getTreeFXDXMax(CVtreeFXDvis[i]);
                        if (CVTempMinMax > maxTreeX) maxTreeX = CVTempMinMax;
                        CVTempMinMax = getTreeFXDXMin(CVtreeFXDvis[i]);
                        if (CVTempMinMax < minTreeX) minTreeX = CVTempMinMax;
                        CVTempMinMax = getTreeFXDYMin(CVtreeFXDvis[i]);
                        if (CVTempMinMax < minTreeY) minTreeY = CVTempMinMax;
                    }
                }
            }
            CVtitle = CVtitle.substring(0, CVtitle.length - 2);
            if (CVtitle.length > 30) {
                CVtitle = CVtitle.substring(0, 28) + '\n' + CVtitle.substring(48);
            }


            svg.append("text")
                .attr("x", (width / 2))
                .attr("y", 0 - (margin.top / 2) + 10)
                .attr("text-anchor", "middle")
                .style("font-size", "16px")
                .text(CVtitle);



            // Add X axis
            var x = d3.scaleLinear()
                .domain([minTreeX, maxTreeX])
                .range([0, width]);
            svg.append("g")
                .attr("transform", "translate(" + 0 + "," + (height) + ")")
                .call(d3.axisBottom(x));

            // Add Y axis
            var y = d3.scaleLinear()
                .domain([maxTreeY, minTreeY])
                .range([height, 0]);
            svg.append("g")
                .call(d3.axisLeft(y));


            // Define the div for the tooltip
            var div = d3.select("body").append("div")
                .attr("class", "tooltip")
                .style("opacity", 0);


            // Formatting data

            for (var i = 0; i < CVCheckboxElements.length; i++) {
                if (CVCheckboxElements[i].checked) {
                    var plots = [];
                    CVtreeFXDvis[i].forEach(element => {
                        plots.push({
                            x: parseInt(element.ScreenX, 10),
                            y: parseInt(element.ScreenY, 10),
                            color: '#FF0000'
                        })
                    });
                    svg.selectAll("polygon")
                        .data([plots])
                        .enter().append("polygon")
                        .style("fill", function (d) {
                            var color;
                            switch (i) {
                                case 0:
                                    color = "#00FF00";
                                    break;
                                case 1:
                                    color = "#cc0099";
                                default: break;
                            }
                            return color;
                        })
                        .attr("points", function (d) {
                            return d.map(function (d) {
                                return [x(d.x), y(d.y)].join(",");
                            }).join(" ");
                        });
                }

            }


        }

        function getTreeFXDYMax(tempTree) {
            return tempTree.reduce((max, p) => {
                if (max.constructor === ({}).constructor) {
                    max = max.ScreenY
                }
                return Math.max(p.ScreenY, max);
            });
        }

        function getTreeFXDXMax(tempTree) {
            return tempTree.reduce((max, p) => {
                if (max.constructor === ({}).constructor) {
                    max = max.ScreenX
                }
                return Math.max(p.ScreenX, max);
            });
        }

        function getTreeFXDXMin(tempTree) {
            return tempTree.reduce((min, p) => {
                if (min.constructor === ({}).constructor) {
                    min = min.ScreenX
                }
                return Math.min(p.ScreenX, min);
            });
        }

        function getTreeFXDYMin(tempTree) {
            return tempTree.reduce((min, p) => {
                if (min.constructor === ({}).constructor) {
                    min = min.ScreenY
                }
                return Math.min(p.ScreenY, min);
            });
        }


    </script>



</body>

</html>


<!-- Styling for the page -->
<style>
    html {
        background-image: linear-gradient(#a5c0ee, #fbc5ec);
    }

    .columns,
    .column {
        margin-bottom: 0 !important;
        padding-bottom: 0 !important;
    }

    .tile_canvas {
        width: 550px !important;
        height: 300px !important;
        padding-left: 0;
        padding-right: 0;
        margin-left: auto;
        margin-right: auto;
        display: block;
    }

    .space {

        margin: 1% 1% 1% 1%;
    }

    .juicy {
        background-color: #603F83FF;
        color: #FFFFFF;
    }

    .dark {
        background-color: #3d3d3d;
    }

    /* Context Menu CSS */
    .context-menu {
        padding: 5% 5% 5% 5%;
    }

    .menu * {
        color: #ffffff !important;
    }

    .start {
        display: block;
    }

    .default {
        display: none;
    }

    .top-spacing {
        margin-top: 2%;
    }

    /* Session Comparison Overview CSS */
    .button_selected {
        background-color: #603F83FF;
        color: #FFFFFF;
    }

    /* Time Comparison CSS */
    .comparison_canvas {
        width: 1000px;
    }

    .selector_label {
        font-size: 20px;
        font-weight: bolder;
        padding: 1% 1% 1% 1%;
    }

    .comparison_button_selected {
        background-color: #603F83FF;
        color: #FFFFFF;
    }


    /*Convex Hull CSS */
    polygon {
        fill: CadetBlue;
        opacity: .3;
    }

    .cvElement {

        border: 1px solid #000;
        margin-bottom: 5px;
        text-align: center;
        background: #eee;
    }

    .CVboxes {
        width: 23%;
        padding: 5px;
        float: left;
        margin: 5px;
        border: 1px solid #aaa;
    }
</style>