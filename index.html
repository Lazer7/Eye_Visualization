<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Eye Visualization</title>
    <!-- Bulma Style Sheet -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bulma-extensions@6.2.7/dist/js/bulma-extensions.min.js"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <!-- Load d3.js -->
    <script src="https://d3js.org/d3.v4.js"></script>
    <!-- Load ChartsJS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.2/dist/Chart.min.js"></script>
    <!-- data -->
    <script src="Data/Others/participant_data.js"></script>
</head>

<body>
    <div class="columns">
        <!-- This section is the context menu HTML -->
        <div class="column is-2 dark">
            <div class="context-menu hero is-fullheight">
                <aside class="menu">
                    <p class="menu-label">
                        Eye Tracking Visualization
                    </p>
                    <ul class="menu-list">
                        <li><a onclick="load('Time_Visualization')">Time Path Comparison</a></li>
                        <li><a onclick="load('Convex_Visualization')">Convex Hull Comparison</a></li>
                        <li><a onclick="load('Participant_Visualization')">Participant Completion Comparison</a></li>
                    </ul>
                    <p class="menu-label">
                        Session Visualization
                    </p>
                    <ul class="menu-list">
                        <li><a onclick="load('Session_Overview')">Overview</a></li>
                        <li><a onclick="load('Time_Comparison')">Time Comparison</a></li>
                        <li><a onclick="load('Completion_Comparison')">Completion Comparison</a></li>
                    </ul>
                </aside>
            </div>
        </div>
        <!-- End of context menu HTML -->
        <!-- This section is the Visualization Code for every visualization image we are creating -->
        <div class="column">
            <div id="Time_Visualization" class="default"> Time Visualization </div>
            <div id="Convex_Visualization" class="default"> Convex Visualization </div>
            <div id="Participant_Visualization" class="default">Participant Completion Visualization</div>
            <div id="Session_Overview" class="default">
                <div class="title">Session Comparison Overview</div>
                <button id="Session_Comparison_Tree" class="button space button_selected"
                    onclick="switchSessionOverview('Session_Comparison_Tree')"><i class="fas fa-tree"></i> &nbsp;
                    Tree</button>
                <button id="Session_Comparison_Graph" class="button space"
                    onclick="switchSessionOverview('Session_Comparison_Graph')"><i class="fas fa-project-diagram"></i>
                    &nbsp; Graph</button>
                <div class="tile is-vertical is-ancestor">
                    <div class="tile is-parent">
                        <div id="General_Session_Time_Average_Container" class="tile notification juicy space">
                            <canvas id="General_Session_Time_Average" class="tile_canvas"></canvas>
                        </div>
                        <div id="Expert_Session_Time_Average_Container" class="tile notification juicy space">
                            <canvas id="Expert_Session_Time_Average" class="tile_canvas"></canvas>
                        </div>
                    </div>
                    <div class="tile is-parent">
                        <div id="General_Session_Time_Average_Container" class="tile notification juicy space">
                            <canvas id="General_Session_Success_Average" class="tile_canvas"></canvas>
                        </div>
                        <div id="Expert_Session_Success_Average_Container" class="tile notification juicy space">
                            <canvas id="Expert_Session_Success_Average" class="tile_canvas"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div id="Time_Comparison" class="default">
                <div class="title">Time Comparison Visualization</div>
                <div>
                    <label class="selector_label">Visualization:</label>
                    <button id="Time_Comparison_Tree" class="button comparison_button_selected"
                        onclick="refreshTimeComparisonChart(1)"><i class="fas fa-tree"></i> &nbsp;
                        Tree
                    </button>
                    <button id="Time_Comparison_Graph" class="button" onclick="refreshTimeComparisonChart(2)"><i
                            class="fas fa-project-diagram"></i>&nbsp;
                        Graph
                    </button>
                    <label class="selector_label">Ontology:</label>
                    <button id="Time_Comparison_General" class="button" onclick="refreshTimeComparisonChart(3)"><i
                            class="fas fa-info-circle"></i> &nbsp;
                        General
                    </button>
                    <button id="Time_Comparison_Expert" class="button" onclick="refreshTimeComparisonChart(4)"><i
                            class="fas fa-atlas"></i>&nbsp;
                        Expert
                    </button>
                    <div id="time_comparison_visualization_container">
                        <canvas id="time_comparison_visualization" class="comparison_canvas"></canvas>
                    </div>
                </div>
            </div>

            <div id="Completion_Comparison" class="start">
                <div class="title">Completion Comparison Visualization</div>
                <div>
                    <label class="selector_label">Visualization:</label>
                    <button id="Completion_Comparison_Tree" class="button comparison_button_selected"
                        onclick="refreshCompletionComparisonChart(1)"><i class="fas fa-tree"></i> &nbsp;
                        Tree
                    </button>
                    <button id="Completion_Comparison_Graph" class="button"
                        onclick="refreshCompletionComparisonChart(2)"><i class="fas fa-project-diagram"></i>&nbsp;
                        Graph
                    </button>
                    <label class="selector_label">Ontology:</label>
                    <button id="Completion_Comparison_General" class="button"
                        onclick="refreshCompletionComparisonChart(3)"><i class="fas fa-info-circle"></i> &nbsp;
                        General
                    </button>
                    <button id="Completion_Comparison_Expert" class="button"
                        onclick="refreshCompletionComparisonChart(4)"><i class="fas fa-atlas"></i>&nbsp;
                        Expert
                    </button>
                    <div id="completion_comparison_visualization_container">
                        <canvas id="completion_comparison_visualization" class="comparison_canvas"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of Visualization Section -->
    </div>


    <!-- Javascript Section -->
    <!-- Embedded Javascript for the context menu-->
    <script>
        function load(id) {
            document.getElementById("Time_Visualization").style.display = "none";
            document.getElementById("Convex_Visualization").style.display = "none";
            document.getElementById("Participant_Visualization").style.display = "none";
            document.getElementById("Session_Overview").style.display = "none";
            document.getElementById("Time_Comparison").style.display = "none";
            document.getElementById("Completion_Comparison").style.display = "none";
            document.getElementById(id).style.display = "block";
        }
    </script>
    <!-- Embedded Javascript for Session_Overview-->
    <script>
        // Locating Session Visualization Overview canvas tiles
        var generalSessionTime = document.getElementById("General_Session_Time_Average");
        var generalSessionSuccess = document.getElementById("General_Session_Success_Average");
        var expertSessionTime = document.getElementById("Expert_Session_Time_Average");
        var expertSessionSuccess = document.getElementById("Expert_Session_Success_Average");
        // Set current comparison to tree (Tree = 1 Graph = 2)
        var sessionOverviewComparisonType = 1;
        // Create the Radar Visualization on the Session Comparison Overview
        refreshSessionOverviewChart();
        // Title is the Title of the visualization
        // canvasElement is the element on the DOM we are drawing onto
        // The participant data
        // Type is a bool value -> true = Time | false = Success
        function generateNewRadarChart(title, canvasElement, data, type) {
            var labels = []; // Participants
            var values = []; // Data Value
            var timeAverage = 0;
            var successAverage = 0;
            // Data Processing (filtering for time or success percentage)
            data.forEach(element => {
                labels.push(element.ID);
                if (type) {
                    values.push(element.Time_On_Task)
                } else {
                    values.push(element.Task_Success * 100)
                }
                timeAverage += element.Time_On_Task;
                successAverage += (element.Task_Success * 100);
            });
            timeAverage = timeAverage / data.length;
            successAverage = successAverage / data.length;
            // Afix the average value onto the title
            title = title + ": " + (type ? timeAverage.toFixed(2) + " min" : successAverage.toFixed(2) + "%");
            new Chart(canvasElement, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        data: values,
                        backgroundColor: type ? "rgba(165, 192, 238, 0.5)" : "rgba(251, 197, 236, 0.5)",
                        fillOpacity: .5,
                        borderWidth: 1
                    }]
                },
                options: {
                    scale: {
                        pointLabels: {
                            fontSize: 15,
                            fontColor: "#FFFFFF"
                        },
                        ticks: {
                            suggestedMin: 0,
                            suggestedMax: type ? 50 : 100
                        }
                    },
                    legend: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: title,
                        fontSize: 30,
                        fontColor: "#FFFFFF",
                        fontStyle: "bolder",
                        padding: 2
                    }
                }
            });

        }

        function refreshSessionOverviewChart() {
            generateNewRadarChart("General Time Average", generalSessionTime, participants
                .filter((e) => {
                    return e.Ontologies === 1 && e.Visualization === sessionOverviewComparisonType;
                }), true);
            generateNewRadarChart("Expert Time Average", expertSessionTime, participants
                .filter((e) => {
                    return e.Ontologies === 2 && e.Visualization === sessionOverviewComparisonType;
                }), true);
            generateNewRadarChart("General Success Average", generalSessionSuccess,
                participants.filter((e) => {
                    return e.Ontologies === 1 && e.Visualization === sessionOverviewComparisonType;
                }), false);
            generateNewRadarChart("Expert Success Average", expertSessionSuccess,
                participants.filter((e) => {
                    return e.Ontologies === 2 && e.Visualization === sessionOverviewComparisonType;
                }), false);
        }

        function switchSessionOverview(type) {
            var tree = document.getElementById("Session_Comparison_Tree");
            var graph = document.getElementById("Session_Comparison_Graph");
            tree.className = "button space";
            graph.className = "button space"
            if (type === "Session_Comparison_Tree") {
                sessionOverviewComparisonType = 1;
                tree.className += " button_selected";
            } else {
                sessionOverviewComparisonType = 2;
                graph.className += " button_selected";
            }
            refreshSessionOverviewChart();
        }
    </script>
    <!-- Embedded Javascript for Time_Comparison -->
    <script>
        var timeComparisonVisualizaton = document.getElementById("time_comparison_visualization");
        // value 1 = Tree | value 2 = Graph | value 3 = General | value 4 = Expert
        var timeVisualizationSelectorValue = 1;
        createTimeComparisonChart();

        function createTimeComparisonChart() {
            var labels = [];
            var values = [{
                label: timeVisualizationSelectorValue >= 3 ? "Tree" : "General",
                backgroundColor: "Red",
                data: []

            }, {
                label: timeVisualizationSelectorValue >= 3 ? "Graph" : "Expert",
                backgroundColor: "Blue",
                data: []

            }];
            participants.forEach((participant) => {
                // Show Tree and Graph Comparison
                if (timeVisualizationSelectorValue >= 3) {
                    var ontologySearchValue = timeVisualizationSelectorValue === 3 ? 1 : 2;
                    if (participant.Ontologies === ontologySearchValue) {
                        labels.push(participant.ID);
                        if (participant.Visualization === 1) {
                            values[0].data.push(participant.Time_On_Task);
                            values[1].data.push(0);
                        } else {
                            values[0].data.push(0);
                            values[1].data.push(participant.Time_On_Task);
                        }
                    }
                }
                // Show General and Expert Comparison
                else {
                    var visualizationSearchValue = timeVisualizationSelectorValue;
                    if (participant.Visualization === visualizationSearchValue) {
                        labels.push(participant.ID);
                        if (participant.Ontologies === 1) {
                            values[0].data.push(participant.Time_On_Task);
                            values[1].data.push(0);
                        } else {
                            values[0].data.push(0);
                            values[1].data.push(participant.Time_On_Task);
                        }
                    }
                }
            });
            new Chart(timeComparisonVisualizaton, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: values,
                    options: {
                        barValueSpacing: 5,
                        scales: {
                            yAxes: [{
                                ticks: {
                                    min: 0,
                                }
                            }]
                        }
                    }
                }

            });

        }

        function refreshTimeComparisonChart(value) {
            timeVisualizationSelectorValue = value;
            var tree = document.getElementById("Time_Comparison_Tree");
            var graph = document.getElementById("Time_Comparison_Graph");
            var general = document.getElementById("Time_Comparison_General");
            var expert = document.getElementById("Time_Comparison_Expert");
            var container = document.getElementById("time_comparison_visualization_container");
            tree.className = "button";
            graph.className = "button";
            general.className = "button";
            expert.className = "button";
            switch (value) {
                case 1:
                    tree.className = "button comparison_button_selected";
                    break;
                case 2:
                    graph.className = "button comparison_button_selected";
                    break;
                case 3:
                    general.className = "button comparison_button_selected";
                    break;
                case 4:
                    expert.className = "button comparison_button_selected";
                    break;
            }
            container.removeChild(timeComparisonVisualizaton);
            var canvas = document.createElement('canvas');
            canvas.id = "time_comparison_visualization";
            canvas.className = "comparison_canvas";
            container.appendChild(canvas);
            timeComparisonVisualizaton = document.getElementById("time_comparison_visualization");
            createTimeComparisonChart();
        }
    </script>

    <!-- Embedded Javascript for Success_Comparison -->
    <script>
        var completionComparisionVisualization = document.getElementById("completion_comparison_visualization");
        // value 1 = Tree | value 2 = Graph | value 3 = General | value 4 = Expert
        var completionVisualizationSelectorValue = 1;
        createCompletionComparisonChart();

        function createCompletionComparisonChart() {
            var labels = [];
            var values = [{
                label: completionVisualizationSelectorValue >= 3 ? "Tree" : "General",
                backgroundColor: "Red",
                data: []

            }, {
                label: completionVisualizationSelectorValue >= 3 ? "Graph" : "Expert",
                backgroundColor: "Blue",
                data: []

            }];
            participants.forEach((participant) => {
                // Show Tree and Graph Comparison
                if (completionVisualizationSelectorValue >= 3) {
                    var ontologySearchValue = completionVisualizationSelectorValue === 3 ? 1 : 2;
                    if (participant.Ontologies === ontologySearchValue) {
                        labels.push(participant.ID);
                        if (participant.Visualization === 1) {
                            values[0].data.push(participant.Task_Success*100);
                            values[1].data.push(0);
                        } else {
                            values[0].data.push(0);
                            values[1].data.push(participant.Task_Success*100);
                        }
                    }
                }
                // Show General and Expert Comparison
                else {
                    var visualizationSearchValue = completionVisualizationSelectorValue;
                    if (participant.Visualization === completionVisualizationSelectorValue) {
                        labels.push(participant.ID);
                        if (participant.Ontologies === 1) {
                            values[0].data.push(participant.Task_Success*100);
                            values[1].data.push(0);
                        } else {
                            values[0].data.push(0);
                            values[1].data.push(participant.Task_Success*100);
                        }
                    }
                }
            });
            new Chart(completionComparisionVisualization, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: values,
                    options: {
                        barValueSpacing: 5,
                        scales: {
                            yAxes: [{
                                ticks: {
                                    max: 100,
                                    min: 0,
                                    stepSize: 10
                                }
                            }]
                        }
                    }
                }

            });

        }

        function refreshCompletionComparisonChart(value) {
            completionVisualizationSelectorValue = value;
            var tree = document.getElementById("Completion_Comparison_Tree");
            var graph = document.getElementById("Completion_Comparison_Graph");
            var general = document.getElementById("Completion_Comparison_General");
            var expert = document.getElementById("Completion_Comparison_Expert");
            var container = document.getElementById("completion_comparison_visualization_container");
            tree.className = "button";
            graph.className = "button";
            general.className = "button";
            expert.className = "button";
            switch (value) {
                case 1:
                    tree.className = "button comparison_button_selected";
                    break;
                case 2:
                    graph.className = "button comparison_button_selected";
                    break;
                case 3:
                    general.className = "button comparison_button_selected";
                    break;
                case 4:
                    expert.className = "button comparison_button_selected";
                    break;
            }
            container.removeChild(completionComparisionVisualization);
            var canvas = document.createElement('canvas');
            canvas.id = "completion_comparison_visualization";
            canvas.className = "comparison_canvas";
            container.appendChild(canvas);
            completionComparisionVisualization = document.getElementById("completion_comparison_visualization");
            createCompletionComparisonChart();
        }
    </script>





</body>

</html>


<!-- Styling for the page -->
<style>
    html {
        background-image: linear-gradient(#a5c0ee, #fbc5ec);
    }

    .columns,
    .column {
        margin-bottom: 0 !important;
        padding-bottom: 0 !important;
    }

    .tile_canvas {
        width: 550px !important;
        height: 300px !important;
        padding-left: 0;
        padding-right: 0;
        margin-left: auto;
        margin-right: auto;
        display: block;
    }

    .space {

        margin: 1% 1% 1% 1%;
    }

    .juicy {
        background-color: #603F83FF;
        color: #FFFFFF;
    }

    .dark {
        background-color: #3d3d3d;
    }

    /* Context Menu CSS */
    .context-menu {
        padding: 5% 5% 5% 5%;
    }

    .menu * {
        color: #ffffff !important;
    }

    .start {
        display: block;
    }

    .default {
        display: none;
    }

    .top-spacing {
        margin-top: 2%;
    }

    /* Session Comparison Overview CSS */
    .button_selected {
        background-color: #603F83FF;
        color: #FFFFFF;
    }

    /* Time Comparison CSS */
    .comparison_canvas {
        width: 1000px;
    }

    .selector_label {
        font-size: 20px;
        font-weight: bolder;
        padding: 1% 1% 1% 1%;
    }

    .comparison_button_selected {
        background-color: #603F83FF;
        color: #FFFFFF;
    }
</style>